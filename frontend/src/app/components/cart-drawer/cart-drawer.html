<!-- Backdrop -->
<div *ngIf="isOpen" class="fixed inset-0 bg-[#00000085] bg-opacity-50 z-40" (click)="closeDrawer()"></div>

<!-- Drawer -->
<div [class.translate-x-0]="isOpen" [class.translate-x-full]="!isOpen" 
     class="fixed right-0 top-0 h-full w-full md:w-96 bg-white shadow-2xl z-50 transform transition-transform duration-300 ease-in-out flex flex-col">
  
  <!-- Header -->
  <div class="p-4 border-b border-gray-200 flex justify-between items-center bg-gray-50">
    <h2 class="text-xl font-bold text-gray-900">ตะกร้าสินค้า</h2>
    <button (click)="closeDrawer()" class="text-gray-500 hover:text-gray-700 transition">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg>
    </button>
  </div>

  <!-- Cart Items -->
  <div class="flex-1 overflow-y-auto p-4">
    <!-- Empty State -->
    <div *ngIf="cartItems.length === 0" class="flex flex-col items-center justify-center h-full text-center py-12">
      <svg class="w-24 h-24 text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
      </svg>
      <h3 class="text-lg font-semibold text-gray-700 mb-2">ตะกร้าว่างเปล่า</h3>
      <p class="text-gray-500 mb-4">เริ่มเลือกซื้อสินค้ากันเถอะ!</p>
      <button (click)="closeDrawer()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">
        เลือกซื้อสินค้า
      </button>
    </div>

    <!-- Cart Items List -->
    <div *ngIf="cartItems.length > 0" class="space-y-4">
      <div *ngFor="let item of cartItems" class="flex gap-4 p-3 bg-gray-50 rounded-lg">
        <!-- Product Image -->
        <img [src]="item.product.image_url" [alt]="item.product.name" 
             class="w-20 h-20 object-cover rounded">
        
        <!-- Product Info -->
        <div class="flex-1">
          <h3 class="font-semibold text-gray-900 text-sm">{{ item.product.name }}</h3>
          <p class="text-sm text-gray-600 mt-1">${{ item.product.price }}</p>
          
          <!-- Quantity Controls -->
          <div class="flex items-center gap-2 mt-2">
            <button (click)="decreaseQuantity(item.product.id)" 
                    class="w-7 h-7 flex items-center justify-center bg-gray-200 rounded hover:bg-gray-300 transition">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path>
              </svg>
            </button>
            <span class="w-8 text-center font-semibold">{{ item.quantity }}</span>
            <button (click)="increaseQuantity(item.product.id)" 
                    class="w-7 h-7 flex items-center justify-center bg-gray-200 rounded hover:bg-gray-300 transition">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
              </svg>
            </button>
          </div>
        </div>

        <!-- Remove Button -->
        <button (click)="removeItem(item.product.id)" 
                class="text-red-500 hover:text-red-700 transition self-start">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div *ngIf="cartItems.length > 0" class="p-4 border-t border-gray-200 bg-gray-50">
    <!-- Total -->
    <div class="flex justify-between items-center mb-4">
      <span class="text-lg font-semibold text-gray-900">ยอดรวม:</span>
      <span class="text-2xl font-bold text-blue-600">${{ cartTotal.toFixed(2) }}</span>
    </div>

    <!-- Checkout Button -->
    <button (click)="goToCheckout()" 
            class="w-full bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition font-semibold">
      ดำเนินการชำระเงิน
    </button>
  </div>
</div>
